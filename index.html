<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>10-Stack - Á¨¨39Âºæ</title>
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; overflow: hidden; background: #263238; font-family: sans-serif; touch-action: none; position: fixed; width: 100%; height: 100%; }
        
        /* Â∫ÉÂëäÊû†Ôºö100px */
        #ad-top, #ad-bottom { position: fixed; left: 0; width: 100%; height: 100px; background: #333; z-index: 100; display: flex; align-items: center; justify-content: center; }
        #ad-top { top: 0; } #ad-bottom { bottom: 0; }
        iframe { border: none; width: 100%; height: 100px; }

        /* „Ç≤„Éº„É†Êú¨‰Ωì„Ç®„É™„Ç¢ */
        #game-outer { position: absolute; top: 100px; bottom: 100px; left: 0; right: 0; background: #37474f; overflow: hidden; display: flex; flex-direction: column; }
        
        #header-ui { width: 100%; display: flex; justify-content: space-around; align-items: center; padding: 10px 0; z-index: 10; color: white; flex-shrink: 0; }
        .ui-box { padding: 4px 10px; border-radius: 8px; font-weight: bold; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); font-size: 14px; }

        /* „Éõ„Éº„É´„Éâ & „Éç„ÇØ„Çπ„ÉàË°®Á§∫ */
        .info-panel { display: flex; gap: 15px; align-items: center; }
        .display-slot { text-align: center; }
        .slot-label { font-size: 10px; color: #b0bec5; margin-bottom: 2px; }
        .slot-val { font-size: 28px; font-weight: bold; width: 45px; height: 45px; background: rgba(0,0,0,0.3); border-radius: 8px; display: flex; align-items: center; justify-content: center; border: 2px solid #546e7a; }
        #hold-slot { border-color: #ff4081; color: #ff4081; cursor: pointer; } /* „Éõ„Éº„É´„Éâ„ÅØ„Éî„É≥„ÇØ */
        #hold-slot:active { transform: scale(0.95); }
        #next-val { color: #ffeb3b; }

        /* „Çπ„Çø„ÉÉ„ÇØ„Ç®„É™„Ç¢ */
        #stack-container { flex-grow: 1; display: flex; justify-content: center; align-items: flex-end; padding-bottom: 15px; gap: 8px; }
        .lane { width: 65px; height: 95%; background: rgba(0,0,0,0.2); border-radius: 8px; display: flex; flex-direction: column-reverse; align-items: center; padding: 5px; gap: 5px; position: relative; }
        
        .block { width: 55px; height: 45px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: bold; color: white; animation: drop 0.2s ease-out; }
        @keyframes drop { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* „É°„Éã„É•„ÉºÁîªÈù¢ */
        #menuScreen { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.92); display: flex; flex-direction: column; 
            align-items: center; justify-content: flex-start; z-index: 50; 
            padding: 10px 0; overflow-y: auto; color: white; -webkit-overflow-scrolling: touch;
        }
        #result-msg { color: #ffeb3b; margin: 10px 0; font-size: 26px; text-align: center; }
        .guide-text { padding: 0 20px; text-align: center; font-size: 13px; margin-bottom: 5px; color: #cfd8dc; }

        #ad-middle-container { width: 300px; height: 120px; background: #000; margin: 10px 0; display: none; justify-content: center; align-items: center; }

        .menu-btn-group { display: flex; flex-direction: column; align-items: center; width: 100%; gap: 10px; padding-bottom: 40px; }
        .menu-btn { width: 260px; padding: 14px; font-size: 16px; border: none; border-radius: 30px; font-weight: bold; cursor: pointer; text-decoration: none; text-align: center; white-space: nowrap; }
        #retry-btn { background: #ffeb3b; color: #000; box-shadow: 0 4px #c6b921; }
        #more-games-btn { background: #ff4081; color: white; box-shadow: 0 4px #c2185b; }
    </style>
</head>
<body>

    <div id="ad-top"><iframe id="frame-top" src="ad.html"></iframe></div>

    <div id="game-outer">
        <div id="header-ui">
            <div id="score-display" class="ui-box">SCORE: 0</div>
            <div class="info-panel">
                <div class="display-slot">
                    <div class="slot-label">HOLD („Çø„ÉÉ„Éó)</div>
                    <div id="hold-slot" class="slot-val" onclick="swapHold()">-</div>
                </div>
                <div class="display-slot">
                    <div class="slot-label">NEXT</div>
                    <div id="next-val" class="slot-val">?</div>
                </div>
            </div>
        </div>
        
        <div id="stack-container">
            <div class="lane" onclick="dropInLane(0)" id="lane-0"></div>
            <div class="lane" onclick="dropInLane(1)" id="lane-1"></div>
            <div class="lane" onclick="dropInLane(2)" id="lane-2"></div>
            <div class="lane" onclick="dropInLane(3)" id="lane-3"></div>
        </div>

        <div id="menuScreen">
            <h2 id="result-msg">10-Stack</h2>
            <p class="guide-text">„É¨„Éº„É≥„Çí„Çø„ÉÉ„Éó„Åó„Å¶ÂêàË®à„Çí<b>„Äå„Å¥„Å£„Åü„Çä10„Äç</b>„Å´ÔºÅ<br><b>HOLDÊû†</b>„Çí„Çø„ÉÉ„Éó„Åô„Çã„Å®‰ªä„ÅÆÊï∞Â≠ó„Çí„Ç≠„Éº„Éó„Åß„Åç„Çã„Åû„ÄÇ<br>10„ÇíË∂Ö„Åà„Çã„Å®Âç≥ÁµÇ‰∫ÜÔºÅ</p>
            
            <div id="ad-middle-container">
                <script src="https://adm.shinobi.jp/s/1e6de436ea850948e238e975a93767eb"></script>
            </div>

            <div class="menu-btn-group">
                <button id="retry-btn" class="menu-btn" onclick="startNewGame()">‚òÖ „Çπ„Çø„Éº„Éà ‚òÖ</button>
                <a href="https://saaaachi.github.io/Color.Match/" id="more-games-btn" class="menu-btn">‚òÖ ‰ªñ„ÅÆ„Ç≤„Éº„É†„ÅØ„Åì„Å°„Çâ ‚òÖ</a>
            </div>
        </div>
    </div>

    <div id="ad-bottom"><iframe id="frame-bottom" src="ad.html"></iframe></div>

    <script>
        let score = 0, gameActive = false;
        let nextValue = 0, holdValue = null;
        let lanes = [[], [], [], []];
        const colors = ["", "#81d4fa", "#4fc3f7", "#29b6f6", "#03a9f4", "#039be5", "#0288d1", "#0277bd", "#01579b", "#b71c1c"];

        function startNewGame() {
            document.getElementById("menuScreen").style.display = "none";
            document.getElementById("ad-middle-container").style.display = "none";
            score = 0; lanes = [[], [], [], []]; holdValue = null;
            gameActive = true;
            updateUI();
            clearLanes();
            generateNext();
            document.getElementById("hold-slot").innerText = "-";
        }

        function clearLanes() {
            for(let i=0; i<4; i++) document.getElementById(`lane-${i}`).innerHTML = "";
        }

        function generateNext() {
            nextValue = Math.floor(Math.random() * 9) + 1;
            document.getElementById("next-val").innerText = nextValue;
        }

        function swapHold() {
            if(!gameActive) return;
            if(holdValue === null) {
                holdValue = nextValue;
                generateNext();
            } else {
                let temp = nextValue;
                nextValue = holdValue;
                holdValue = temp;
            }
            document.getElementById("hold-slot").innerText = holdValue;
            document.getElementById("next-val").innerText = nextValue;
        }

        function dropInLane(laneIdx) {
            if(!gameActive) return;
            const laneData = lanes[laneIdx];
            const currentTotal = laneData.reduce((a, b) => a + b, 0);

            if(currentTotal + nextValue > 10) {
                gameOver("10„ÇíË∂Ö„Åà„Å°„ÇÉ„Å£„ÅüÔºÅüò±");
                return;
            }

            laneData.push(nextValue);
            const block = document.createElement("div");
            block.className = "block";
            block.innerText = nextValue;
            block.style.backgroundColor = colors[nextValue];
            document.getElementById(`lane-${laneIdx}`).appendChild(block);

            if(laneData.reduce((a, b) => a + b, 0) === 10) {
                setTimeout(() => {
                    score += 10;
                    lanes[laneIdx] = [];
                    document.getElementById(`lane-${laneIdx}`).innerHTML = "";
                    updateUI();
                }, 150);
            }
            generateNext();
        }

        function updateUI() {
            document.getElementById("score-display").innerText = "SCORE: " + score;
        }

        function gameOver(msg) {
            gameActive = false;
            document.getElementById("result-msg").innerText = msg + "\nSCORE: " + score;
            document.getElementById("ad-middle-container").style.display = "flex";
            document.getElementById("menuScreen").style.display = "flex";
            document.getElementById("menuScreen").scrollTop = 0;
        }

        setInterval(() => {
            const t = document.getElementById('frame-top');
            const b = document.getElementById('frame-bottom');
            if(t) t.src = t.src; if(b) b.src = b.src;
        }, 30000);

        window.onload = () => { document.getElementById("menuScreen").style.display = "flex"; };
    </script>
</body>
</html>
