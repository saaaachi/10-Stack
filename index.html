<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>10-Stack - ç¬¬39å¼¾</title>
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; overflow: hidden; background: #263238; font-family: sans-serif; touch-action: none; position: fixed; width: 100%; height: 100%; }
        
        /* åºƒå‘Šæ ï¼š100px */
        #ad-top, #ad-bottom { position: fixed; left: 0; width: 100%; height: 100px; background: #333; z-index: 100; display: flex; align-items: center; justify-content: center; }
        #ad-top { top: 0; } #ad-bottom { bottom: 0; }
        iframe { border: none; width: 100%; height: 100px; }

        /* ã‚²ãƒ¼ãƒ æœ¬ä½“ã‚¨ãƒªã‚¢ */
        #game-outer { position: absolute; top: 100px; bottom: 100px; left: 0; right: 0; background: #37474f; overflow: hidden; display: flex; flex-direction: column; }
        
        #header-ui { width: 100%; display: flex; justify-content: space-around; padding: 10px 0; z-index: 10; color: white; flex-shrink: 0; }
        .ui-box { padding: 4px 12px; border-radius: 8px; font-weight: bold; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); }

        /* ã‚¹ã‚¿ãƒƒã‚¯ã‚¨ãƒªã‚¢ */
        #stack-container { flex-grow: 1; display: flex; justify-content: center; align-items: flex-end; padding-bottom: 20px; gap: 8px; }
        .lane { width: 60px; height: 90%; background: rgba(0,0,0,0.2); border-radius: 8px; display: flex; flex-direction: column-reverse; align-items: center; padding: 5px; gap: 5px; position: relative; }
        
        .block { width: 50px; height: 50px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; color: white; animation: drop 0.2s ease-out; }
        @keyframes drop { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        #next-box { text-align: center; }
        #next-val { font-size: 32px; font-weight: bold; color: #ffeb3b; }

        /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿®æ­£ï¼‰ */
        #menuScreen { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.9); display: flex; flex-direction: column; 
            align-items: center; justify-content: flex-start; z-index: 50; 
            padding: 10px 0; overflow-y: auto; color: white; -webkit-overflow-scrolling: touch;
        }
        
        /* 1è¡Œã«åã‚ã‚‹ãŸã‚ã®èª¿æ•´ */
        #result-msg { color: #ffeb3b; margin: 10px 0; font-size: 28px; text-align: center; line-height: 1.2; }
        .guide-text { padding: 0 20px; text-align: center; font-size: 14px; margin-bottom: 10px; flex-shrink: 0; }

        #ad-middle-container { width: 300px; height: 120px; background: #000; margin: 10px 0; display: none; justify-content: center; align-items: center; flex-shrink: 0; }

        .menu-btn-group { display: flex; flex-direction: column; align-items: center; width: 100%; gap: 10px; padding-bottom: 40px; flex-shrink: 0; }
        .menu-btn { 
            width: 260px; /* å°‘ã—å¹…ã‚’åºƒã’ã¦1è¡Œã«åã¾ã‚Šã‚„ã™ã */
            padding: 14px; 
            font-size: 16px; 
            border: none; 
            border-radius: 30px; 
            font-weight: bold; 
            cursor: pointer; 
            text-decoration: none; 
            text-align: center; 
            white-space: nowrap; /* æ”¹è¡Œç¦æ­¢ */
        }
        #retry-btn { background: #ffeb3b; color: #000; box-shadow: 0 4px #c6b921; }
        #more-games-btn { background: #ff4081; color: white; box-shadow: 0 4px #c2185b; }
    </style>
</head>
<body>

    <div id="ad-top"><iframe id="frame-top" src="ad.html"></iframe></div>

    <div id="game-outer">
        <div id="header-ui">
            <div id="score-display" class="ui-box">SCORE: 0</div>
            <div id="next-box">NEXT: <span id="next-val">?</span></div>
        </div>
        
        <div id="stack-container">
            <div class="lane" onclick="dropInLane(0)" id="lane-0"></div>
            <div class="lane" onclick="dropInLane(1)" id="lane-1"></div>
            <div class="lane" onclick="dropInLane(2)" id="lane-2"></div>
            <div class="lane" onclick="dropInLane(3)" id="lane-3"></div>
        </div>

        <div id="menuScreen">
            <h2 id="result-msg">10-Stack</h2>
            <p class="guide-text">ãƒ¬ãƒ¼ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦æ•°å­—ã‚’é…ç½®ï¼<br>ç¸¦ã®åˆè¨ˆã‚’<b>ã€Œã´ã£ãŸã‚Š10ã€</b>ã«ã—ã¦æ¶ˆãã†ã€‚<br>10ã‚’è¶…ãˆã‚‹ã¨çµ‚äº†ï¼</p>
            
            <div id="ad-middle-container">
                <script src="https://adm.shinobi.jp/s/1e6de436ea850948e238e975a93767eb"></script>
            </div>

            <div class="menu-btn-group">
                <button id="retry-btn" class="menu-btn" onclick="startNewGame()">â˜… ã‚¹ã‚¿ãƒ¼ãƒˆ â˜…</button>
                <a href="https://saaaachi.github.io/Color.Match/" id="more-games-btn" class="menu-btn">â˜… ä»–ã®ã‚²ãƒ¼ãƒ ã¯ã“ã¡ã‚‰ â˜…</a>
            </div>
        </div>
    </div>

    <div id="ad-bottom"><iframe id="frame-bottom" src="ad.html"></iframe></div>

    <script>
        let score = 0, gameActive = false;
        let nextValue = 0;
        let lanes = [[], [], [], []];
        const colors = ["", "#81d4fa", "#4fc3f7", "#29b6f6", "#03a9f4", "#039be5", "#0288d1", "#0277bd", "#01579b", "#b71c1c"];

        const menuScreen = document.getElementById("menuScreen");
        const adMid = document.getElementById("ad-middle-container");
        const resultMsg = document.getElementById("result-msg");
        const retryBtn = document.getElementById("retry-btn");

        function startNewGame() {
            menuScreen.style.display = "none";
            adMid.style.display = "none";
            score = 0;
            lanes = [[], [], [], []];
            gameActive = true;
            updateUI();
            clearLanes();
            generateNext();
        }

        function clearLanes() {
            for(let i=0; i<4; i++) document.getElementById(`lane-${i}`).innerHTML = "";
        }

        function generateNext() {
            nextValue = Math.floor(Math.random() * 9) + 1;
            document.getElementById("next-val").innerText = nextValue;
        }

        function dropInLane(laneIdx) {
            if(!gameActive) return;

            const laneData = lanes[laneIdx];
            const currentTotal = laneData.reduce((a, b) => a + b, 0);

            if(currentTotal + nextValue > 10) {
                gameOver("10ã‚’è¶…ãˆã¡ã‚ƒã£ãŸï¼ğŸ˜±");
                return;
            }

            laneData.push(nextValue);
            const block = document.createElement("div");
            block.className = "block";
            block.innerText = nextValue;
            block.style.backgroundColor = colors[nextValue];
            document.getElementById(`lane-${laneIdx}`).appendChild(block);

            if(laneData.reduce((a, b) => a + b, 0) === 10) {
                setTimeout(() => {
                    score += 10;
                    lanes[laneIdx] = [];
                    document.getElementById(`lane-${laneIdx}`).innerHTML = "";
                    updateUI();
                }, 200);
            }
            generateNext();
        }

        function updateUI() {
            document.getElementById("score-display").innerText = "SCORE: " + score;
        }

        function gameOver(msg) {
            gameActive = false;
            resultMsg.innerText = msg + "\nSCORE: " + score;
            retryBtn.innerText = "â˜… ã‚‚ã†ä¸€åº¦éŠã¶ â˜…";
            adMid.style.display = "flex";
            menuScreen.style.display = "flex";
            menuScreen.scrollTop = 0; // ä¸Šéƒ¨ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æˆ»ã™
        }

        function refreshAds() {
            const t = document.getElementById('frame-top');
            const b = document.getElementById('frame-bottom');
            if(t) t.src = t.src;
            if(b) b.src = b.src;
        }
        setInterval(refreshAds, 30000);

        window.onload = () => { menuScreen.style.display = "flex"; };
    </script>
</body>
</html>
